{% extends 'base.html' %}

{% block title %}CloudShare - Download Center{% endblock %}

{% block content %}
<div class="flex flex-col gap-8 max-w-4xl mx-auto py-8">
    
    <div class="flex flex-col items-center text-center animate-fade-in-down">
        <div
            class="mb-4 p-4 rounded-full bg-primary/10 text-primary border border-primary/20 shadow-[0_0_30px_rgba(244,37,140,0.2)]">
            <span class="material-symbols-outlined text-5xl">cloud_download</span>
        </div>
        <h1 class="text-4xl md:text-5xl font-black text-white tracking-tight uppercase leading-none mb-4">
            Download <span class="text-primary">Center</span>
        </h1>
        <p class="text-text-muted text-lg max-w-2xl">
            Import files directly to your secure vault from any external URL or share link.
        </p>
    </div>

    
    <div class="bg-surface-dark border border-surface-border rounded-2xl p-8 shadow-2xl relative overflow-hidden group animate-fade-in-up"
        style="animation-delay: 0.1s;">
        
        <div
            class="absolute inset-0 bg-[radial-gradient(circle_at_50%_0%,rgba(244,37,140,0.05)_0%,transparent_70%)] opacity-50 group-hover:opacity-100 transition-opacity duration-700">
        </div>

        <form method="POST" action="{% url 'upload_from_url' %}" class="relative z-10 flex flex-col gap-6"
            onsubmit="showDownloadSuccess()">
            {% csrf_token %}

            <div class="flex flex-col gap-2">
                <label class="text-xs font-bold text-text-muted uppercase tracking-widest ml-1">Source URL</label>
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <span
                            class="material-symbols-outlined text-text-muted group-focus-within:text-primary transition-colors">link</span>
                    </div>
                    <input type="url" name="url" required placeholder="Paste direct download link (http://...)"
                        class="w-full h-14 bg-background-dark border border-surface-border rounded-xl pl-12 pr-4 text-white placeholder-text-muted/50 focus:border-primary focus:ring-1 focus:ring-primary transition-all shadow-inner">
                    
                    <div
                        class="absolute -inset-[1px] -z-10 rounded-xl bg-gradient-to-r from-primary to-blue-600 opacity-0 group-focus-within:opacity-50 blur transition-opacity duration-300">
                    </div>
                </div>
            </div>

            <button type="submit"
                class="w-full h-14 bg-primary hover:bg-primary-hover text-white font-black tracking-[0.2em] uppercase rounded-xl shadow-[0_0_20px_rgba(244,37,140,0.3)] hover:shadow-[0_0_35px_rgba(244,37,140,0.5)] active:scale-[0.99] transition-all flex items-center justify-center gap-3">
                <span class="material-symbols-outlined">download</span>
                <span>Initiate Transfer</span>
            </button>
        </form>
    </div>

    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 animate-fade-in-up" style="animation-delay: 0.2s;">
        <div
            class="bg-surface-dark/50 border border-surface-border p-6 rounded-xl text-center hover:bg-surface-dark transition-colors">
            <span class="material-symbols-outlined text-3xl text-primary mb-3">content_copy</span>
            <h3 class="text-white font-bold mb-1">1. Copy Link</h3>
            <p class="text-xs text-text-muted">Get the direct download URL from any external source.</p>
        </div>
        <div
            class="bg-surface-dark/50 border border-surface-border p-6 rounded-xl text-center hover:bg-surface-dark transition-colors">
            <span class="material-symbols-outlined text-3xl text-primary mb-3">input</span>
            <h3 class="text-white font-bold mb-1">2. Paste URL</h3>
            <p class="text-xs text-text-muted">Enter the link in the input field above.</p>
        </div>
        <div
            class="bg-surface-dark/50 border border-surface-border p-6 rounded-xl text-center hover:bg-surface-dark transition-colors">
            <span class="material-symbols-outlined text-3xl text-primary mb-3">cloud_done</span>
            <h3 class="text-white font-bold mb-1">3. Auto-Save</h3>
            <p class="text-xs text-text-muted">File is automatically downloaded and saved to your vault.</p>
        </div>
    </div>
</div>


<div id="download-success-overlay"
    class="fixed inset-0 z-50 flex items-center justify-center bg-background-dark/90 backdrop-blur-md opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="flex flex-col items-center transform scale-90 transition-transform duration-300" id="success-content">
        <div class="relative size-24 mb-6">
            <div class="absolute inset-0 bg-emerald-500/20 rounded-full animate-ping"></div>
            <div
                class="relative size-full bg-surface-dark border-2 border-emerald-500 rounded-full flex items-center justify-center text-emerald-500 shadow-[0_0_30px_rgba(16,185,129,0.3)]">
                <span class="material-symbols-outlined text-5xl">check_circle</span>
            </div>
        </div>
        <h2 class="text-3xl font-black text-white uppercase tracking-tight mb-2">Transfer Initiated</h2>
        <p class="text-text-muted animate-pulse">Processing file download...</p>
    </div>
</div>

<style>
    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in-down {
        animation: fadeInDown 0.6s ease-out forwards;
    }

    .animate-fade-in-up {
        animation: fadeInUp 0.6s ease-out forwards;
    }
</style>

<script>
    function showDownloadSuccess() {
        const overlay = document.getElementById('download-success-overlay');
        const content = document.getElementById('success-content');

        overlay.classList.remove('opacity-0', 'pointer-events-none');
        content.classList.remove('scale-90');
        content.classList.add('scale-100');

        // Let the form submit normally, the page will reload with the backend success message
    }
</script>
{% endblock %}